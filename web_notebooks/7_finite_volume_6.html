<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Finite volumes 6 - flux boundary conditions &#8212; E213</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"TeX": {"equationNumbers": {"autoNumber": "AMS", "useLabelIds": true}, "extensions": ["color.js"]}, "tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          Home</a>
        <span class="navbar-text navbar-version pull-left"><b>2019Jan01</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../week_notes.html">1. Weekly notes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../week_notes.html#week-1-jan-3">1.1. Week 1  Jan 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week_notes.html#week-2-jan-8-jan-10">1.2. Week 2  Jan 8/Jan 10</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week_notes.html#week-3-jan-15-jan-17">1.3. Week 3  Jan 15/Jan 17</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week_notes.html#week-4-jan-22-jan-24">1.4. Week 4  Jan 22/Jan 24</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week_notes.html#week-5-jan-29-jan-31">1.5. Week 5  Jan 29/Jan 31</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week_notes.html#week-6-feb-05-feb-07">1.6. Week 6  Feb 05/Feb 07</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week_notes.html#general-notes">1.7. General notes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../solutions.html">2. Assignment solutions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../solutions.html#week-2">2.1. Week 2</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../texts.html">3. Texts</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../texts.html#math">3.1. Math</a></li>
<li class="toctree-l2"><a class="reference internal" href="../texts.html#python">3.2. Python</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">4. Python</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../getting_started.html#python-introductory-texts">4.1. Python Introductory Texts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started.html#moving-from-matlab-to-python">4.2. Moving from matlab to python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started.html#cocalc">4.3. Cocalc</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cheat_sheet.html">5. Cheat sheet</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../cheat_sheet.html#useful-shell-commands">5.1. Useful shell commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cheat_sheet.html#useful-git-commands">5.2. Useful git commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cheat_sheet.html#useful-debugger-commands">5.3. Useful debugger commands</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../notebook_index.html">6. Notebook index</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../week_notes.html">1. Weekly notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../solutions.html">2. Assignment solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../texts.html">3. Texts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">4. Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cheat_sheet.html">5. Cheat sheet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook_index.html">6. Notebook index</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../_sources/web_notebooks/7_finite_volume_6.ipynb.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li class="toctree-l1"><a class="reference internal" href="../week_notes.html">1. Weekly notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../solutions.html">2. Assignment solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../texts.html">3. Texts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">4. Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cheat_sheet.html">5. Cheat sheet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook_index.html">6. Notebook index</a></li>
</ul>

        </div>
      </div>
    <div class="col-md-9 content">
      
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 7ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<h1><p>Table of Contents</p>
</h1><div class="toc"><ul class="toc-item"><li><p>1&nbsp;&nbsp;Finite volumes 6 - flux boundary conditions</p>
</li><li><p>2&nbsp;&nbsp;Learning goals</p>
</li><li><p>3&nbsp;&nbsp;Prescribed flux boundary conditions</p>
<ul class="toc-item"><li><p>3.1&nbsp;&nbsp;Summary of finite-volume equations (1-d, steady-state, no sources within the volume)</p>
<ul class="toc-item"><li><p>3.1.1&nbsp;&nbsp;Fundamental 1-d steady-state FV equation</p>
</li><li><p>3.1.2&nbsp;&nbsp;In terms of specific fluxes and areas of finite-volume faces (for regular retangular gridblocks):</p>
</li><li><p>3.1.3&nbsp;&nbsp;Location of flux boundary condition</p>
</li><li><p>3.1.4&nbsp;&nbsp;Implications for grid and boundary condition locations</p>
</li><li><p>3.1.5&nbsp;&nbsp;Example</p>
</li><li><p>3.1.6&nbsp;&nbsp;Prescribed flux boundary condition in a discrete approximation</p>
</li><li><p>3.1.7&nbsp;&nbsp;In terms of concentrations in gridblocks:</p>
</li></ul></li><li><p>3.2&nbsp;&nbsp;Your turn</p>
</li><li><p>3.3&nbsp;&nbsp;Your turn - general case</p>
</li><li><p>3.4&nbsp;&nbsp;Your turn</p>
</li></ul></li><li><p>4&nbsp;&nbsp;2-D steady-state</p>
<ul class="toc-item"><li><p>4.1&nbsp;&nbsp;Your turn</p>
<ul class="toc-item"><li><p>4.1.1&nbsp;&nbsp;Question</p>
</li></ul></li></ul></li><li><p>5&nbsp;&nbsp;Gridblock example - flux boundary conditions</p>
<ul class="toc-item"><li><p>5.1&nbsp;&nbsp;Your turn</p>
</li></ul></li></ul></div><div class="section" id="Finite-volumes-6---flux-boundary-conditions">
<h1>Finite volumes 6 - flux boundary conditions<a class="headerlink" href="#Finite-volumes-6---flux-boundary-conditions" title="Permalink to this headline">¶</a></h1>
</div>
<div class="section" id="Learning-goals">
<h1>Learning goals<a class="headerlink" href="#Learning-goals" title="Permalink to this headline">¶</a></h1>
<ol class="arabic simple">
<li>Be able to apply flux boundary conditions to a finite volume approximation.</li>
<li>To be able to compute local and global mass balance from a finite-volume discrete approximation.</li>
<li>Justify the use of harmonic averaging for heterogeneous diffusion coefficients to maintain mass balance.</li>
<li>Be able to express a finite-volume formulation in integral notation and identify each term in the integral expression.</li>
<li>Be able to describe the steps required to develop a general finite volume approximation for arbitrarily shaped elements.</li>
</ol>
</div>
<div class="section" id="Prescribed-flux-boundary-conditions">
<h1>Prescribed flux boundary conditions<a class="headerlink" href="#Prescribed-flux-boundary-conditions" title="Permalink to this headline">¶</a></h1>
<p>For many problems, a prescribed flux is a natural boundary condition: * for solute diffusion - it prescribes the rate at which solute is fluxing into the problem domain (eg sulfate). * for water flow, a flux boundary condition describes the rate at which water enters into the problem domain. * perhaps the most common is a <strong>zero flux</strong> boundary condition - where the boundary is prescribed to not allow flux of a quantity across the boundary.</p>
<p>Well first review the fundamental FV equations and show that flux boundary conditions can be easily incorporated into our stencils.</p>
<div class="section" id="Summary-of-finite-volume-equations-(1-d,-steady-state,-no-sources-within-the-volume)">
<h2>Summary of finite-volume equations (1-d, steady-state, no sources within the volume)<a class="headerlink" href="#Summary-of-finite-volume-equations-(1-d,-steady-state,-no-sources-within-the-volume)" title="Permalink to this headline">¶</a></h2>
<div class="section" id="Fundamental-1-d-steady-state-FV-equation">
<h3>Fundamental 1-d steady-state FV equation<a class="headerlink" href="#Fundamental-1-d-steady-state-FV-equation" title="Permalink to this headline">¶</a></h3>
<p>We developed the finite-volume approximations starting from the fundamental conservation equation which is already written in terms of fluxes:</p>
<p><span class="math">\begin{align}
\left(J_{EC}+J_{WC}\right) &= 0 \label{eq761}\\
\end{align}</span></p>
</div>
<div class="section" id="In-terms-of-specific-fluxes-and-areas-of-finite-volume-faces-(for-regular-retangular-gridblocks):">
<h3>In terms of specific fluxes and areas of finite-volume faces (for regular retangular gridblocks):<a class="headerlink" href="#In-terms-of-specific-fluxes-and-areas-of-finite-volume-faces-(for-regular-retangular-gridblocks):" title="Permalink to this headline">¶</a></h3>
<p><span class="math">\begin{align}
&\left(j_{EC}+j_{WC}\right) (\Delta y) (\Delta z) = 0 \label{eq762}\\
\end{align}</span></p>
<p>If our gridblock C lies on the boundary, a <strong>prescribed flux boundary condition</strong> means that one fluxes entering the gridblock is prescribed (known).</p>
</div>
<div class="section" id="Location-of-flux-boundary-condition">
<h3>Location of flux boundary condition<a class="headerlink" href="#Location-of-flux-boundary-condition" title="Permalink to this headline">¶</a></h3>
<p>For our 1-d problem, with the fluxes aligned with the <span class="math notranslate nohighlight">\(x\)</span> direction, we have something that looks like</p>
<p><a class="reference internal" href="../_images/single_block_flux.png"><img alt="pic02" src="../_images/single_block_flux.png" style="width: 20.0%;" /></a></p>
<p>The fluxes <span class="math notranslate nohighlight">\(j_{EC}\)</span> and <span class="math notranslate nohighlight">\(j_{WC}\)</span> enter at the <strong>boundary</strong> of gridblock C - between EC and WC: <a class="reference internal" href="web_notebooks/figures/finite_volume_1d_uniform.png"><img alt="pic03" src="web_notebooks/figures/finite_volume_1d_uniform.png" style="width: 20.0%;" /></a></p>
<p>It is therefore best to conceive of the fluxes as being located at the <strong>boundary</strong> between gridblocks.</p>
</div>
<div class="section" id="Implications-for-grid-and-boundary-condition-locations">
<h3>Implications for grid and boundary condition locations<a class="headerlink" href="#Implications-for-grid-and-boundary-condition-locations" title="Permalink to this headline">¶</a></h3>
<p>When we are modeling a physical system: * we place the edge of the gridblock on the boundary if the boundary is a prescribed flux boundary; * we place the node on the boundary if it is a prescribed concentration boundary.</p>
<p><a class="reference internal" href="web_notebooks/figures/bc_location.png"><img alt="pic04" src="web_notebooks/figures/bc_location.png" style="width: 40.0%;" /></a></p>
</div>
<div class="section" id="Example">
<h3>Example<a class="headerlink" href="#Example" title="Permalink to this headline">¶</a></h3>
<p>Consider our simple 5-node example. In the physical system to be modeled, a flux of <span class="math notranslate nohighlight">\(j=0.37\times 10^{-8}~mg/(s\cdot m^2)\)</span> of sulfate is entering from the left of the domain and the concentration is prescribed (fixed) at <span class="math notranslate nohighlight">\(c=9 ~mg/L\)</span> on the right boundary:</p>
<p><a class="reference internal" href="web_notebooks/figures/2d_flux.png"><img alt="pic05" src="web_notebooks/figures/2d_flux.png" style="width: 20.0%;" /></a></p>
</div>
<div class="section" id="Prescribed-flux-boundary-condition-in-a-discrete-approximation">
<h3>Prescribed flux boundary condition in a discrete approximation<a class="headerlink" href="#Prescribed-flux-boundary-condition-in-a-discrete-approximation" title="Permalink to this headline">¶</a></h3>
<p>Prescribing a flux boundary condition is equivalent to prescribing the value of <span class="math notranslate nohighlight">\(j_{WC}\)</span> or <span class="math notranslate nohighlight">\(j_{EC}\)</span> in a discrete approximation. So in our example above, for gridblock 1, the equation would look like: <span class="math">\begin{align}
&\left(j_{EC}+j_{WC}\right) (\Delta y) (\Delta z) = 0 \label{eq763}\\
&\left(j_{21}+0.37\times 10^{-8}\right) (\Delta y) (\Delta z) = 0 \label{eq764}\\
\end{align}</span></p>
<p>Be careful with the signs! Is the sign correct for the flux if it is entering gridblock 1?</p>
</div>
<div class="section" id="In-terms-of-concentrations-in-gridblocks:">
<h3>In terms of concentrations in gridblocks:<a class="headerlink" href="#In-terms-of-concentrations-in-gridblocks:" title="Permalink to this headline">¶</a></h3>
<p>Below is the equation for a generic gridblock C in the middle of the mesh. Let’s see below how to modify it for a flux boundary condition. <span class="math">\begin{align}
&\left(D\theta {c_E - c_C \over \Delta x} +   D\theta {c_W - c_C \over \Delta x}   \right) (\Delta y) (\Delta z) = 0 \label{eq765}\\
\end{align}</span></p>
</div>
</div>
<div class="section" id="Your-turn">
<h2>Your turn<a class="headerlink" href="#Your-turn" title="Permalink to this headline">¶</a></h2>
<p>For the 5-node example above, write the equation for gridblock 1, where <span class="math notranslate nohighlight">\(\Delta x=1~m\)</span>, <span class="math notranslate nohighlight">\(\Delta y = 1.5~m\)</span>, <span class="math notranslate nohighlight">\(\Delta z = 2.0~m\)</span>, <span class="math notranslate nohighlight">\(D\theta=10^{-9}~m^2/s\)</span> and the flux on the left edge of gridblock 1 is <span class="math notranslate nohighlight">\(j = 0.37\times 10^{-8}~ mg/(s\cdot m^2)\)</span>: <span class="math">\begin{align}
&\left(D\theta {c_E - c_C \over \Delta x} +   D\theta {c_W - c_C \over \Delta x}   \right) (\Delta y) (\Delta z) = 0 \label{eq766}\\\end{align}</span></p>
</div>
<div class="section" id="Your-turn---general-case">
<h2>Your turn - general case<a class="headerlink" href="#Your-turn---general-case" title="Permalink to this headline">¶</a></h2>
<p>Modify the equation below for the general case where the flux from W is prescribed to be <span class="math notranslate nohighlight">\(j_{WC} = f\)</span>, <span class="math notranslate nohighlight">\(f&gt;0\)</span>. <span class="math">\begin{align}
&\left(D\theta {c_E - c_C \over \Delta x} +   D\theta {c_W - c_C \over \Delta x}   \right) (\Delta y) (\Delta z) = 0 \label{eq767}\\\end{align}</span></p>
</div>
<div class="section" id="Your-turn">
<h2>Your turn<a class="headerlink" href="#Your-turn" title="Permalink to this headline">¶</a></h2>
<p>Modify the generic equation below for the case where the flux from E is prescribed to be <span class="math notranslate nohighlight">\(j_{EC} = 0\)</span>, (no-flux boundary condition): <span class="math">\begin{align}
&\left(D\theta {c_E - c_C \over \Delta x} +   D\theta {c_W - c_C \over \Delta x}   \right) (\Delta y) (\Delta z) = 0 \label{eq768}\\
\end{align}</span></p>
</div>
</div>
<div class="section" id="2-D-steady-state">
<h1>2-D steady-state<a class="headerlink" href="#2-D-steady-state" title="Permalink to this headline">¶</a></h1>
<p>In 2-D, the general stencils for an interior gridblock C in terms of total flux, specific flux and concentrations are: <span class="math">\begin{align}
&\left(J_{EC}+J_{WC} + J_{NC}+J_{SC}\right) = 0 \label{eq769}\\
\end{align}</span></p>
<p><span class="math">\begin{align}
&\left(j_{EC}+j_{WC}\right) (\Delta y) (\Delta z) +\left(j_{NC}+j_{SC}\right) (\Delta x) (\Delta z)  = 0 \label{eq7610}\\
\end{align}</span></p>
<p><span class="math">\begin{align}
&\left(D\theta {c_E - c_C \over \Delta x} +   D\theta {c_W - c_C \over \Delta x}   \right) (\Delta y) (\Delta z)
+\left(D\theta {c_N - c_C \over \Delta y} +   D\theta {c_S - c_C \over \Delta y}   \right) (\Delta x) (\Delta z)= 0 \label{eq7611}\\
\end{align}</span></p>
<p><a class="reference internal" href="web_notebooks/figures/2d_flux.png"><img alt="pic05" src="web_notebooks/figures/2d_flux.png" style="width: 20.0%;" /></a></p>
<div class="section" id="Your-turn">
<h2>Your turn<a class="headerlink" href="#Your-turn" title="Permalink to this headline">¶</a></h2>
<p>Modify each of the three equations below for the situation where there is no flux to or from gridblocks N and S:</p>
<p><span class="math">\begin{align}
\left(J_{EC}+J_{WC} + J_{NC}+J_{SC}\right) = 0 \label{eq7612}\\
\end{align}</span></p>
<p><span class="math">\begin{align}
\left(j_{EC}+j_{WC}\right) (\Delta y) (\Delta z) +\left(j_{NC}+j_{SC}\right) (\Delta x) (\Delta z)  = 0 \label{eq7613}\\
\end{align}</span></p>
<p><span class="math">\begin{align}
&\left(D\theta {c_E - c_C \over \Delta x} +   D\theta {c_W - c_C \over \Delta x}   \right) (\Delta y) (\Delta z)
+\left(D\theta {c_N - c_C \over \Delta y} +   D\theta {c_S - c_C \over \Delta y}   \right) (\Delta x) (\Delta z)= 0\label{eq7614}\\
\end{align}</span></p>
<div class="section" id="Question">
<h3>Question<a class="headerlink" href="#Question" title="Permalink to this headline">¶</a></h3>
<p>The result should be a familiar stencil. What is it?</p>
</div>
</div>
</div>
<div class="section" id="Gridblock-example---flux-boundary-conditions">
<h1>Gridblock example - flux boundary conditions<a class="headerlink" href="#Gridblock-example---flux-boundary-conditions" title="Permalink to this headline">¶</a></h1>
<p>Let’s write the equations for the 5-gridblock example from before, now with a flux boundary condition as shown (note <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> coordinate directions are as indicated,with <span class="math notranslate nohighlight">\(z\)</span> into the page).</p>
<p><a class="reference internal" href="web_notebooks/figures/5node-flux-bc.png"><img alt="pic06" src="web_notebooks/figures/5node-flux-bc.png" style="width: 50.0%;" /></a></p>
<p>The total length of the domain is <span class="math notranslate nohighlight">\(2~m\)</span> in the <span class="math notranslate nohighlight">\(x\)</span> direction, each gridblock is the same size and porosity and diffusion coefficient are spatially homogeneous: * <span class="math notranslate nohighlight">\(\Delta x=2/4.5 = 0.44~ m\)</span> * <span class="math notranslate nohighlight">\(\Delta y=0.3~m\)</span> * <span class="math notranslate nohighlight">\(\Delta z=0.5~m\)</span> * <span class="math notranslate nohighlight">\(D=2\times 10^{-10}~m^2/s\)</span> * <span class="math notranslate nohighlight">\(\theta = 0.25\)</span></p>
<p>Note that the <em>edge</em> of gridblock 1 is on the physical boundary whereas the node of gridblock 5 is on the physical boundary. Accordingly, there are 4.5 gridblocks across the 2-m domain, so each gridblock is 0.44 m in the x direction.</p>
<div class="section" id="Your-turn">
<h2>Your turn<a class="headerlink" href="#Your-turn" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li>Write the equations for the unknowns in the problem.</li>
<li>Solve the system of equations for the unknown concentrations. <em>(If you are doing this by hand, note that you can rescale any equation by dividing or multiplying all terms in the equation by the same number. Often it is convenient to divide all terms by the coefficient of the unknown on the “diagonal” - for equation number :math:`n`, the diagonal is the coefficient that multiplies :math:`c_n`.)</em></li>
<li>In the cell below, report the concentration you computed in gridblock 1.</li>
<li>In the cell after that, use concentration values to compute the magnitude (i.e.&nbsp;a positive number) of the specific flux (in <span class="math notranslate nohighlight">\(mg/(s\cdot m^2)\)</span>) between gridblocks 4 and 5.</li>
</ol>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>
<span></span># YOUR CODE HERE
raise NotImplementedError()
</pre></div>
</div>
</div>
<p>2a. Fill out the following A and b matrices for this problem, overwriting the non-zero values with your coefficients:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="o">=</span>

 <span class="p">[[</span><span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span><span class="p">]</span>
 <span class="p">[</span><span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span><span class="p">]</span>
 <span class="p">[</span><span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span><span class="p">]</span>
 <span class="p">[</span><span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span><span class="p">]</span>
 <span class="p">[</span><span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span><span class="p">]]</span>

<span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span><span class="p">]</span>
</pre></div>
</div>
<p>YOUR ANSWER HERE</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>
<span></span># 2b. solve the equations you just wrote down for the concentration c in steadcy state
#
# Our solution in this cell follows the same pattern as the week6_assign.  That is,
# we defined a function called build_1d_matrix_source that produce a 5x5 matrix A
# and a 5x1 vector b, such that the 5 cell concentrations c can be found with the
# following python code
#
# A,b = build_1d_matrix_source(...)
# c = np.linalg.solve(A, b)
#
# You can also show your hand calculations here.  If you do it by hand
# leave the concentrations in a list named c, so we can check the values
# like this
#
# c=[c1,c2,c3,c4,c5]
#
# we will check your c[0]=c1 value against ours in a test below.
#

# YOUR CODE HERE
raise NotImplementedError()
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>
<span></span># In this cell show that for you value of the c vector, you do in fact get:
# A@c=b  (either by hand or with python code in this cell)

# YOUR CODE HERE
raise NotImplementedError()
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>
<span></span># 3. We check your c[0] for cell 1 here


</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-none notranslate"><div class="highlight"><pre>
<span></span># 4. We check your value for the flux between grid blocks 4 and 5 (c[3] and c[4])
</pre></div>
</div>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2019, Philip Austin.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.3.<br/>
    </p>
  </div>
</footer>
  </body>
</html>