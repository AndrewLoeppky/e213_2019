<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Learning goals &#8212; E213</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"TeX": {"equationNumbers": {"autoNumber": "AMS", "useLabelIds": true}, "extensions": ["color.js"]}, "tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          Home</a>
        <span class="navbar-text navbar-version pull-left"><b>2019Jan01</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../week_notes.html">1. Weekly notes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../week_notes.html#week-1-jan-3">1.1. Week 1  Jan 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week_notes.html#week-2-jan-8-jan-10">1.2. Week 2  Jan 8/Jan 10</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week_notes.html#week-3-jan-15-jan-17">1.3. Week 3  Jan 15/Jan 17</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week_notes.html#week-4-jan-22-jan-24">1.4. Week 4  Jan 22/Jan 24</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week_notes.html#week-5-jan-29-jan-31">1.5. Week 5  Jan 29/Jan 31</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week_notes.html#week-6-feb-05-feb-07">1.6. Week 6  Feb 05/Feb 07</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week_notes.html#week-7-feb-19-feb-21">1.7. Week 7  Feb 19/Feb 21</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week_notes.html#week-8-feb-26-feb-28">1.8. Week 8  Feb 26/Feb 28</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week_notes.html#week-9-mar-05-mar-07">1.9. Week 9  Mar 05/Mar 07</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week_notes.html#week-10-mar-12-mar-14">1.10. Week 10  Mar 12/Mar 14</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week_notes.html#week-11-mar19-mar-21">1.11. Week 11 Mar19/Mar 21</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week_notes.html#week-12-mar26-mar28">1.12. Week 12 Mar26/Mar28</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week_notes.html#general-notes">1.13. General notes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../solutions.html">2. Assignment solutions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../solutions.html#week-2">2.1. Week 2</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../texts.html">3. Texts</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../texts.html#math">3.1. Math</a></li>
<li class="toctree-l2"><a class="reference internal" href="../texts.html#python">3.2. Python</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">4. Python</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../getting_started.html#python-introductory-texts">4.1. Python Introductory Texts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started.html#moving-from-matlab-to-python">4.2. Moving from matlab to python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started.html#cocalc">4.3. Cocalc</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cheat_sheet.html">5. Cheat sheet</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../cheat_sheet.html#useful-shell-commands">5.1. Useful shell commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cheat_sheet.html#useful-git-commands">5.2. Useful git commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cheat_sheet.html#useful-debugger-commands">5.3. Useful debugger commands</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../notebook_index.html">6. Notebook index</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../week_notes.html">1. Weekly notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../solutions.html">2. Assignment solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../texts.html">3. Texts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">4. Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cheat_sheet.html">5. Cheat sheet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook_index.html">6. Notebook index</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../_sources/web_notebooks/9_pdes_1.ipynb.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li class="toctree-l1"><a class="reference internal" href="../week_notes.html">1. Weekly notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../solutions.html">2. Assignment solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../texts.html">3. Texts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">4. Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cheat_sheet.html">5. Cheat sheet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook_index.html">6. Notebook index</a></li>
</ul>

        </div>
      </div>
    <div class="col-md-9 content">
      
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 7ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<h1><p>Table of Contents</p>
</h1><div class="toc"><ul class="toc-item"><li><p>1&nbsp;&nbsp;Learning goals</p>
</li><li><p>2&nbsp;&nbsp;Approach to develop a partial differential equation</p>
<ul class="toc-item"><li><p>2.1&nbsp;&nbsp;2-d transient mass - balance statement</p>
</li><li><p>2.2&nbsp;&nbsp;Sign conventions</p>
</li><li><p>2.3&nbsp;&nbsp;Upshot</p>
</li><li><p>2.4&nbsp;&nbsp;Per unit volume, per unit time</p>
</li><li><p>2.5&nbsp;&nbsp;Your turn</p>
</li><li><p>2.6&nbsp;&nbsp;Partial differential equation</p>
</li></ul></li><li><p>3&nbsp;&nbsp;Conservation of mass equation in 3 dimensions</p>
<ul class="toc-item"><li><p>3.1&nbsp;&nbsp;Interpretation</p>
</li><li><p>3.2&nbsp;&nbsp;Your turn</p>
</li><li><p>3.3&nbsp;&nbsp;Divergence of a vector</p>
</li><li><p>3.4&nbsp;&nbsp;Your turn</p>
</li></ul></li><li><p>4&nbsp;&nbsp;Vector notation</p>
<ul class="toc-item"><li><p>4.1&nbsp;&nbsp;Why <span class="math notranslate nohighlight">\(\vec{\nabla}\)</span>?</p>
</li></ul></li><li><p>5&nbsp;&nbsp;Diffusion equation</p>
<ul class="toc-item"><li><p>5.1&nbsp;&nbsp;Your turn</p>
</li><li><p>5.2&nbsp;&nbsp;Constant diffusion coefficient</p>
</li><li><p>5.3&nbsp;&nbsp;Diffusion in porous media</p>
</li><li><p>5.4&nbsp;&nbsp;For homogeneous porosity</p>
</li></ul></li><li><p>6&nbsp;&nbsp;Solving PDEs: Boundary - value problems</p>
<ul class="toc-item"><li><p>6.1&nbsp;&nbsp;Boundary-value problem checklist</p>
</li><li><p>6.2&nbsp;&nbsp;TMF BVP example</p>
</li><li><p>6.3&nbsp;&nbsp;Equation</p>
</li><li><p>6.4&nbsp;&nbsp;Domain</p>
</li><li><p>6.5&nbsp;&nbsp;Properties of the problem domain</p>
</li><li><p>6.6&nbsp;&nbsp;Boundary conditions</p>
</li><li><p>6.7&nbsp;&nbsp;Initial conditions</p>
</li></ul></li><li><p>7&nbsp;&nbsp;Assignment</p>
</li><li><p>8&nbsp;&nbsp;1 Finding an analytical solution</p>
<ul class="toc-item"><li><p>8.1&nbsp;&nbsp;Your turn</p>
</li></ul></li><li><p>9&nbsp;&nbsp;2 Interpretation</p>
<ul class="toc-item"><li><p>9.1&nbsp;&nbsp;1.</p>
</li><li><p>9.2&nbsp;&nbsp;2.</p>
</li><li><p>9.3&nbsp;&nbsp;3.</p>
</li><li><p>9.4&nbsp;&nbsp;4.</p>
</li></ul></li></ul></div><div class="section" id="Learning-goals">
<h1>Learning goals<a class="headerlink" href="#Learning-goals" title="Permalink to this headline">¶</a></h1>
<ol class="arabic simple">
<li>Be able to take a discrete approximation to limit of infinitesimal volume size and time step to arrive at the partial differential equation.</li>
<li>Be able to read a partial differential equation:</li>
</ol>
<ul class="simple">
<li>distinguish between terms that represent fluxes, sources and storage of quantities within the volume (infinitesimal point).</li>
<li>recognize the order of the equation.</li>
<li>recognize conservative forms</li>
</ul>
<ol class="arabic simple" start="3">
<li>Be able to simplify a partial differential equation when coefficients are constant.</li>
<li>Recognize the conservation principle in integral form and match it to the corresponding partial differential equation.</li>
<li>Be able to set up boundary value problem:</li>
</ol>
<ul class="simple">
<li>define domain of the problem.</li>
<li>define the equations that govern the dependent variable.</li>
<li>define the parameters of the equation, and if they are spatially homogeneous (do not vary in space) or heterogeneous.</li>
<li>distinguish between the principal boundary conditions that prevail.</li>
<li>assign initial conditions (if a time dependent problem).</li>
</ul>
<ol class="arabic simple" start="6">
<li>Be able to understand the significance of the mathematical concept of divergence and its relationship to flux at a point.</li>
<li>Be able to recognize a partial differential equation when written in vector form using divergence and gradient.</li>
</ol>
</div>
<div class="section" id="Approach-to-develop-a-partial-differential-equation">
<h1>Approach to develop a partial differential equation<a class="headerlink" href="#Approach-to-develop-a-partial-differential-equation" title="Permalink to this headline">¶</a></h1>
<ol class="arabic simple">
<li>Write a discrete approximation for mass conservation for a finite volume.</li>
<li>Take limits as the size of the volume element and the time period of consideration shrink to infinitesimal size.</li>
<li>Recognize limits as derivatives. Where the independent variable (eg concentration) is a function of more than one dependent variable (typically 3 space dimensions <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span> and <span class="math notranslate nohighlight">\(z\)</span>, and <span class="math notranslate nohighlight">\(t\)</span>), the derivatives are partial.</li>
</ol>
<div class="section" id="2-d-transient-mass---balance-statement">
<h2>2-d transient mass - balance statement<a class="headerlink" href="#2-d-transient-mass---balance-statement" title="Permalink to this headline">¶</a></h2>
<p>We’ll do this in 2-d. From that we can easily go to either 3-d or 1-d.</p>
<p>We’ll consider the transient case, where mass is changing in time in the volume. Let’s consider the simple 2-d stencil, where the gridblock is of size <span class="math notranslate nohighlight">\(\Delta x\)</span>, <span class="math notranslate nohighlight">\(\Delta y\)</span>, <span class="math notranslate nohighlight">\(\Delta z\)</span> (where <span class="math notranslate nohighlight">\(\Delta z\)</span> is into the page in the figure below).</p>
<p>Recall from notebook <code class="docutils literal notranslate"><span class="pre">5.1_finite_volume_2.ipynb</span></code> A transient conservation statement is * <a href="#id1"><span class="problematic" id="id2">**</span></a>the change of the quanity in the volume over a time <span class="math notranslate nohighlight">\(\Delta t\)</span> = the net flux of the quantity into the volume over the time period <span class="math notranslate nohighlight">\(\Delta t\)</span> <a href="#id3"><span class="problematic" id="id4">**</span></a>.</p>
<p>To make things more concrete, let’s consider the case where the conserved quantity is mass <span class="math notranslate nohighlight">\(m\)</span>, such as sulfate.</p>
<p>In one dimension, the transient conservation expression is (from <code class="docutils literal notranslate"><span class="pre">5.1_finite_volume_2.ipynb</span></code>):</p>
<div class="math notranslate nohighlight">
\begin{align}
\Delta m_C = m_C(t+\Delta t) - m_C(t) &amp; = (J_E+J_W)\Delta t \label{1dcons}\\
\end{align}</div><p>where both sides of the equation have dimensions of mass: * <span class="math notranslate nohighlight">\(m_C(t)~\left[M\right]\)</span> is the mass in gridblock C at time <span class="math notranslate nohighlight">\(t\)</span> and <span class="math notranslate nohighlight">\(m_C(t+\Delta t)~\left[M\right]\)</span> is the mass in gridblock C at time <span class="math notranslate nohighlight">\(t+\Delta t\)</span> * <span class="math notranslate nohighlight">\((J_E+J_W)\Delta t~\left[M\right]\)</span> is the net mass that fluxed into volume over time period <span class="math notranslate nohighlight">\(\Delta t\)</span>.</p>
<p>If we now go to 2-d and express this equation in terms of specific fluxes <span class="math notranslate nohighlight">\({j}\)</span>, and recall that <span class="math notranslate nohighlight">\({J}=jA\)</span> where we multiply the net specific flux by the area of the boundary of volume perpendicular to the flux component (<em>eg</em> for fluxes in the <span class="math notranslate nohighlight">\(x\)</span> direction, the area perpendicular is <span class="math notranslate nohighlight">\(\Delta y \Delta z\)</span>):</p>
<div class="math notranslate nohighlight">
\begin{align}
\left(m_C(t+\Delta t) - m_C(t)\right) = \left\{\left(j_{EC} + j_{WC}\right) \Delta y \Delta z +  \left(j_{NC} + j_{SC}\right) \Delta x \Delta z \right\}\Delta t \label{7pde1}\\
\end{align}</div></div>
<div class="section" id="Sign-conventions">
<h2>Sign conventions<a class="headerlink" href="#Sign-conventions" title="Permalink to this headline">¶</a></h2>
<p>The next step is to re-express the fluxes in the discrete approximation such as <span class="math notranslate nohighlight">\(j_{EC}\)</span> in terms of components of a flux vector that varies continuously with location (here in 2-d) <span class="math notranslate nohighlight">\(\vec{j}= \left\{j_x, j_y\right\}\)</span> - the “true” flux that is approximated at gridblock edges by <span class="math notranslate nohighlight">\(j_{EC}\)</span>, etc. The only “trick” here is to be careful of the sign conventions.</p>
<p>In contrast to our finite volume convention where fluxes such as <span class="math notranslate nohighlight">\(j_{EC}\)</span> are <strong>positive</strong> for flux <strong>into the volume</strong>, in math, a vector component is <strong>positive</strong> if the vector is pointing in the direction in which the <strong>coordinate direction corresponding to that component is increasing</strong>.</p>
<p>We’ll demonstrate this for the <span class="math notranslate nohighlight">\(x\)</span> direction here. Consider gridblock C where the left (W) face is located at <span class="math notranslate nohighlight">\(x\)</span> and the right (E) face is located a position <span class="math notranslate nohighlight">\(x+\Delta x\)</span>. First, recognize that both <span class="math notranslate nohighlight">\(j_{WC}\)</span> and <span class="math notranslate nohighlight">\(j_{EC}\)</span> are <span class="math notranslate nohighlight">\(x\)</span> flux components.</p>
<p>Here is the correspondence:</p>
<ul class="simple">
<li><span class="math notranslate nohighlight">\(j_{WC}\)</span> corresponds to <span class="math notranslate nohighlight">\(j_x(x,y,z)\)</span> because when <span class="math notranslate nohighlight">\(j_x\)</span> is positive, flux enters C, just like <span class="math notranslate nohighlight">\(j_{WC}\)</span></li>
<li><span class="math notranslate nohighlight">\(j_{EC}\)</span> corresponds to <span class="math notranslate nohighlight">\(-j_x(x+\Delta x,y,z)\)</span> because when <span class="math notranslate nohighlight">\(-j_x\)</span> is positive flux enters C, just like <span class="math notranslate nohighlight">\(j_{EC}\)</span></li>
</ul>
<blockquote>
<div>Example, for some hypothetical situation, <span class="math notranslate nohighlight">\(j_x(x,y,z) = 3~mg/(s\cdot m^2)\)</span> and <span class="math notranslate nohighlight">\(j_x(x+\Delta x,y,z) = -2.5~mg/(s\cdot m^2)\)</span>, then * on the W face, <span class="math notranslate nohighlight">\(j_x\)</span> is directed in the positive <span class="math notranslate nohighlight">\(x\)</span> direction, so is flowing into C, so <span class="math notranslate nohighlight">\(j_{WC} = j_x(x,y,z) = 3~ mg/(s\cdot m^2)\)</span> * on the E face, <span class="math notranslate nohighlight">\(j_x\)</span> is directed in the negative <span class="math notranslate nohighlight">\(x\)</span> direction, so is flowing into C, so <span class="math notranslate nohighlight">\(j_{EC} = -j_x(x+\Delta x,y,z) = 2.5 ~mg/(s\cdot m^2)\)</span></div></blockquote>
</div>
<div class="section" id="Upshot">
<h2>Upshot<a class="headerlink" href="#Upshot" title="Permalink to this headline">¶</a></h2>
<p>In our conservation statement <span class="math">\ref{7pde1}</span>, we replace <span class="math notranslate nohighlight">\(j_{WC}\rightarrow j_x(x,y,z)\)</span> and <span class="math notranslate nohighlight">\(j_{EC} \rightarrow -j_x(x+\Delta x,y,z)\)</span>. Similarly, in the <span class="math notranslate nohighlight">\(y\)</span> direction <span class="math notranslate nohighlight">\(j_{SC}\rightarrow j_y(x,y,z)\)</span> and <span class="math notranslate nohighlight">\(j_{NC} \rightarrow -j_y(x,y+\Delta y,z)\)</span> The conservation statement <span class="math">\ref{7pde1}</span> becomes:</p>
<div class="math notranslate nohighlight">
\begin{align}
m_C(t+\Delta t) - m_C(t) = \left\{\left(-j_x(x+\Delta x,y,z)+j_x(x,y,z) \right) \Delta y \Delta z +  \left(-j_y(x,y+\Delta y,z) + j_y(x,y,z)\right) \Delta x \Delta z \right\}\Delta t \label{7pde2}\\
\end{align}</div></div>
<div class="section" id="Per-unit-volume,-per-unit-time">
<h2>Per unit volume, per unit time<a class="headerlink" href="#Per-unit-volume,-per-unit-time" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div>Next, divide the equation by the volume of the control volume (gridblock), <span class="math notranslate nohighlight">\((\Delta x)(\Delta y) (\Delta z)\)</span> and time interval <span class="math notranslate nohighlight">\((\Delta t)\)</span>:</div></blockquote>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}:nowrap:\\\begin{split}  \begin{align}
  {m_C(t+\Delta t) - m_C(t)\over (\Delta t)(\Delta x)(\Delta y) (\Delta z)}
  = {-j_x(x+\Delta x,y,z)+j_x(x,y,z) \over  \Delta x} +  {-j_y(x,y+\Delta y,z) + j_y(x,y,z)\over  \Delta y}  \label{7pde3}\\
  \end{align}\end{split}\\Because concentration is mass over volume, in :nbsphinx-math:`\ref{7pde3}` we can substitute concentration :math:`c` for :math:`m_C`, mass in the control volume C. If we substitute :math:`{m_C\over (\Delta x)(\Delta y) (\Delta z)}\rightarrow c`:\end{aligned}\end{align} \]</div>
<div class="math notranslate nohighlight">
\begin{align}
{ c(t+\Delta t) - c(t)\over \Delta t}
= { -j_x(x+\Delta x,y,z)+j_x(x,y,z)  \over  \Delta x} +  { -j_y(x,y+\Delta y,z) + j_y(x,y,z) \over  \Delta y}  \label{7pde4}\\
\end{align}</div></div>
<div class="section" id="Your-turn">
<h2>Your turn<a class="headerlink" href="#Your-turn" title="Permalink to this headline">¶</a></h2>
<p>Answer the following questions in this cell:</p>
<ol class="arabic simple">
<li>What are the dimensions of each term in the conservation equation above <span class="math">\ref{7pde4}</span>? <span class="math notranslate nohighlight">\(\left[ DIMENSIONS~HERE\right]\)</span></li>
<li>Does this term <span class="math notranslate nohighlight">\({ c(t+\Delta t) - c(t)\over \Delta t}\)</span> remind you of anything from calculus? What? <strong>type answer here</strong></li>
<li>Does this term <span class="math notranslate nohighlight">\({-j_y(x,y+\Delta y,z) + j_y(x,y,z)\over \Delta y}\)</span> remind you of anything from calculus? What? <strong>type answer here</strong></li>
</ol>
</div>
<div class="section" id="Partial-differential-equation">
<h2>Partial differential equation<a class="headerlink" href="#Partial-differential-equation" title="Permalink to this headline">¶</a></h2>
<p>The conservation equation <span class="math">\ref{7pde4}</span> is an algebraic equation that applies to a finite-sized control volume C. When we divided by volume and time, we re-expressed the expression on a per unit volume, per unit time basis. Next, we are going to take limits and shrink the volume and time to infinitesimals. In the process, the equation will transform from an algebraic equation to a differential equation. Up to now, we have been considering finite-sized volumes and fluxes in and out
over time periods, with a differential equation, we can think of fluxes in and out of mathematical points over instances in time.</p>
<p>Recognize</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}:nowrap:\\\begin{split}  \begin{align}
  &amp;\lim_{\Delta t, \Delta x,\Delta y,\Delta z \rightarrow 0} { c(t+\Delta t) - c(t)\over \Delta t} = {\partial c\over \partial t}\\
  &amp;\\
  &amp;\lim_{\Delta t, \Delta x,\Delta y,\Delta z \rightarrow 0}{-j_x(x+\Delta x,y,z)+j_x(x,y,z) \over  \Delta x}= -{\partial j_x\over \partial x}\\
  &amp;\\
  &amp;\lim_{\Delta t, \Delta x,\Delta y,\Delta z \rightarrow 0}{-j_y(x,y+\Delta y,z)+j_y(x,y,z) \over  \Delta y}= -{\partial j_y\over \partial y}\\
  \end{align}\end{split}\\So the algebraic equation becomes the **partial differential equation** (pde)\end{aligned}\end{align} \]</div>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}:nowrap:\\\begin{split}  \begin{align}
  {\partial c\over \partial t} &amp;= -{\partial j_x\over \partial x}-{\partial j_y\over \partial y} \label{7pde5}\\
  \end{align}\end{split}\\# Conservation of mass equation in 3 dimensions In three dimensions, (Cartesian coordinates):\end{aligned}\end{align} \]</div>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}:nowrap:\\\begin{split}  \begin{align}
  {\partial c\over \partial t} &amp;= -{\partial j_x\over \partial x}-{\partial j_y\over \partial y}-{\partial j_z\over \partial z}  \label{7pde6}\\
  \end{align}\end{split}\\## Interpretation You can interpret this pde just the way we interpreted our finite-volume conservation statements:\end{aligned}\end{align} \]</div>
<div class="math notranslate nohighlight">
\begin{align}
\overbrace{\partial c\over \partial t}^\text{rate of mass change at point} &amp;= \underbrace{-{\partial j_x\over \partial x}-{\partial j_y\over \partial y}-{\partial j_z\over \partial z}}_\text{net flux rate into a point}  \label{7pde7}\\
\end{align}</div><p>The left side is the rate of change of mass per unit volume at a point, and the right hand side (the sum of the terms) is the net rate at which mass is fluxing into the point per unit volume.</p>
</div>
<div class="section" id="Your-turn">
<h2>Your turn<a class="headerlink" href="#Your-turn" title="Permalink to this headline">¶</a></h2>
<p>Answer the question in this cell. 1. What are the dimensions of each term in the pde <span class="math">\ref{7pde7}</span>? Do those dimensions agree with the description above?</p>
<p>The dimensions are <span class="math notranslate nohighlight">\(\left[\text{Replace with correct dimensions}\right]\)</span></p>
</div>
<div class="section" id="Divergence-of-a-vector">
<h2>Divergence of a vector<a class="headerlink" href="#Divergence-of-a-vector" title="Permalink to this headline">¶</a></h2>
<p>The <strong>divergence</strong> of a flux vector <span class="math notranslate nohighlight">\(\vec{j}=(j_x, j_y, j_z)\)</span> is a <strong>number</strong>, defined as</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}:nowrap:\\\begin{split}  \begin{align}
  \text{divergence of }\vec{j} &amp;= {{\partial j_x\over \partial x}+{\partial j_y\over \partial y}+{\partial j_z\over \partial z}}  \label{7pde8}\\
  \end{align}\end{split}\\In pictures, the divergence is the rate per unit volume at which a flux is spreading **out** from a point. In the picture below, the lines indicate flux directions. On the left, flux is diverging from the point, so at that point it is **positive**. On the right, flux is converging to a point, so the divergence is **negative**.\end{aligned}\end{align} \]</div>
</div>
<div class="section" id="Your-turn">
<h2>Your turn<a class="headerlink" href="#Your-turn" title="Permalink to this headline">¶</a></h2>
<p>Answer the question in this cell.</p>
<ol class="arabic simple">
<li>What does it mean if at a point, the divergence of the flux is zero <span class="math notranslate nohighlight">\({{\partial j_x\over \partial x}+{\partial j_y\over \partial y}+{\partial j_z\over \partial z}}=0\)</span>?</li>
</ol>
</div>
</div>
<div class="section" id="Vector-notation">
<h1>Vector notation<a class="headerlink" href="#Vector-notation" title="Permalink to this headline">¶</a></h1>
<p>The divergence is a concept from vector calculus and is found in most pdes that describe conservation laws. Accordingly it gets a special <em>nabla</em>, <span class="math notranslate nohighlight">\(\nabla\)</span>, notation (see <a class="reference external" href="https://en.wikipedia.org/wiki/Del">https://en.wikipedia.org/wiki/Del</a>):</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}:nowrap:\\\begin{split}  \begin{align}
  \vec{\nabla} \cdot \vec{j} = \text{div}~\vec{j} = \text{divergence of }\vec{j} &amp;= {{\partial j_x\over \partial x}+{\partial j_y\over \partial y}+{\partial j_z\over \partial z}}  \label{7pde9}\\
  \end{align}\end{split}\\The nabla :math:`\vec{\nabla}` is a vector - calculus operator: it takes action &quot;operates&quot; on an argument. In Cartesian coordinates, it is often written as a vector:\end{aligned}\end{align} \]</div>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}:nowrap:\\\begin{split}  \begin{align}
  \vec{\nabla}  &amp;= \left({{\partial  \over \partial x},{\partial  \over \partial y},{\partial  \over \partial z}}\right)  \label{7pde10}\\
  \end{align}\end{split}\\**Divergence of a flux** : the nabla vector maps a flux vector to a scalar number, the divergence (the net flux rate per unit volume):\end{aligned}\end{align} \]</div>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}:nowrap:\\\begin{split}  \begin{align}
  \vec{\nabla} \cdot \vec{j} =\left({{\partial  \over \partial x},{\partial  \over \partial y},{\partial  \over \partial z}}\right)  \cdot \left\{\begin{array}{c}
  j_x\\
  j_y\\
  j_z\\
  \end{array}\right\} = {{\partial j_x\over \partial x}+{\partial j_y\over \partial y}+{\partial j_z\over \partial z}}
  \label{7pde11}
  \end{align}\end{split}\\**Gradient of a scalar**\end{aligned}\end{align} \]</div>
<p>A scalar is a single-valued function: at each point it has one value, unlike a flux which is a vector function - at each point it has 3 components (in a 3-d system). The gradient operator takes a scalar function and produces a vector that points in the direction in which the function is increasing. The nabla notation is used for the gradient (here for the case of concentration <span class="math notranslate nohighlight">\(c\)</span>):</p>
<div class="math notranslate nohighlight">
\begin{align}
\vec{\nabla} c &amp;= \left({{\partial c \over \partial x},{\partial c \over \partial y},{\partial c \over \partial z}}\right)  \label{7pde12}\\
\end{align}</div><p>The latter is sometimes written as:</p>
<div class="math notranslate nohighlight">
\begin{equation}
\vec{\nabla} c = \overrightarrow{\text{grad}} c
\end{equation}</div><p><strong>Fick’s law</strong></p>
<p>Fick’s law of diffusion says that the diffusive flux <span class="math notranslate nohighlight">\(\vec{j}\)</span> is a vector that points in the opposite direction of the concentration gradient. We can now write Fick’s law in vector-calculus nabla notation:</p>
<div class="math notranslate nohighlight">
\begin{align}
\vec{j} = -D \vec{\nabla} c &amp;= \left({-D {\partial c \over \partial x},-D {\partial c \over \partial y},-D {\partial c \over \partial z}}\right)  \label{7pde13}\\
\end{align}</div><p>where <span class="math notranslate nohighlight">\(D~\left[L^2/T\right]\)</span> is the diffusion coefficient. That is, each component of the diffusive flux is:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}:nowrap:\\\begin{split}  \begin{align}
  j_x &amp;= - D {\partial c \over \partial x}\\
  j_y &amp;= - D {\partial c\over \partial y}\\
  j_z &amp;= - D {\partial c\over \partial z}\\
  \end{align}\end{split}\\## Why :math:`\vec{\nabla}`?\end{aligned}\end{align} \]</div>
<p>Why bother with the nabla notation? <strong>Clarity</strong>. Using the nabla notation, we clear up the clutter with partials here and there and make the connection to a conservation law very clear. Our conservation PDE becomes:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}:nowrap:\\\begin{split}  \begin{align}
  {\partial c\over \partial t} &amp;= -{\partial j_x\over \partial x}-{\partial j_y\over \partial y}-{\partial j_z\over \partial z}  \quad\quad\rightarrow\quad\quad {\partial c\over \partial t}= -\vec{\nabla} \cdot \vec{j}  \label{7pde14}\\
  \end{align}\end{split}\\In the righthand form of the equation, we can quickly see the divergence of a flux and &quot;read&quot; the equation quickly. If you see the divergence of a flux, then you are looking at a conservation statement.\end{aligned}\end{align} \]</div>
</div>
<div class="section" id="Diffusion-equation">
<h1>Diffusion equation<a class="headerlink" href="#Diffusion-equation" title="Permalink to this headline">¶</a></h1>
<p>We can now put this all together to get the diffusion equation. That is, we substitute components of Fick’s law <span class="math">\ref{7pde13}</span> into the conservation of mass equation <span class="math">\ref{7pde6}</span>:</p>
<div class="math notranslate nohighlight">
\begin{align}
&amp;{\partial c\over \partial t} = {\partial \over \partial x}\left( D {\partial c \over \partial x}\right) + {\partial \over \partial y}\left( D {\partial c \over \partial y}\right)+ {\partial \over \partial z}\left( D {\partial c \over \partial z}\right)  \label{7pde15}\\
\text{or}&amp;\nonumber\\
&amp;{\partial c\over \partial t} = \vec{\nabla} \cdot (D \vec{\nabla} c)\label{7pde16}\\
\end{align}</div><p>which can also be written as</p>
<div class="math notranslate nohighlight">
\begin{equation}
\frac{\partial c}{\partial t} = \text{div} (D \overrightarrow{\text{grad}} c)
\end{equation}</div><p>These notations are used in everywhere the scientific literature, that’s why we are introducing them. But you should be able to make the link between them, and most importantly, relate to the mass-balance problem from which we have started them.</p>
<div class="section" id="Your-turn">
<h2>Your turn<a class="headerlink" href="#Your-turn" title="Permalink to this headline">¶</a></h2>
<p>Modify this transient 3-d diffusion equation into the steady-state 2-d (<span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> dimensions) equation:</p>
<div class="math notranslate nohighlight">
\begin{align}
&amp;{\partial c\over \partial t} = {\partial \over \partial x}\left( D {\partial c \over \partial x}\right) + {\partial \over \partial y}\left( D {\partial c \over \partial y}\right)+ {\partial \over \partial z}\left( D {\partial c \over \partial z}\right)  \label{7pde17}\\
\end{align}</div></div>
<div class="section" id="Constant-diffusion-coefficient">
<h2>Constant diffusion coefficient<a class="headerlink" href="#Constant-diffusion-coefficient" title="Permalink to this headline">¶</a></h2>
<p>If the diffusion coefficient does not vary with position (is spatially homogeneous), we can simplify terms in the equation. For example by the chain rule:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}:nowrap:\\\begin{split}  \begin{align}
  {\partial \over \partial x}\left( D {\partial c \over \partial x}\right)=  {\partial D \over \partial x}{\partial c \over \partial x} + D{\partial^2 c \over \partial x^2}= 0 + D {\partial^2 c\over \partial x^2}  \label{7pde18}\\
  \end{align}\end{split}\\since if :math:`D` is homogeneous, it is not a function of :math:`x`, :math:`y`, or :math:`z` so :math:`{\partial D\over\partial x}= {\partial D\over\partial y}={\partial D\over\partial z}=0` and the equation becomes\end{aligned}\end{align} \]</div>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}:nowrap:\\\begin{split}  \begin{align}
  &amp;{\partial c\over \partial t} = D{\partial^2 c \over \partial x^2}+ D{\partial^2 c\over \partial y^2}+ D{\partial^2 c\over \partial z^2}  \label{7pde19}\\
  \end{align}\end{split}\\This equation is sometimes written using nabla notation as:\end{aligned}\end{align} \]</div>
<div class="math notranslate nohighlight">
\begin{align}
&amp;{\partial c\over \partial t} = D \nabla^2 c   \label{7pde20}\\
\end{align}</div></div>
<div class="section" id="Diffusion-in-porous-media">
<h2>Diffusion in porous media<a class="headerlink" href="#Diffusion-in-porous-media" title="Permalink to this headline">¶</a></h2>
<p>Earlier in <code class="docutils literal notranslate"><span class="pre">5.1_finite_volume_3.ipynb</span></code> we saw that Fick’s law of diffusion in porous media is (given here in vector notation):</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}:nowrap:\\\begin{split}  \begin{align}
  \vec{j} = -D\theta\vec{\nabla} c c \label{7pde21}\\
  \end{align}\end{split}\\where :math:`\theta` is the porosity. To develop the PDE for diffusion in porous media, we have to change the storage term. If the entire control volume is filled with water, then for a dissolved solute like sulfate, the mass of sulfate is the concentration :math:`\times` volume of the control volume:\end{aligned}\end{align} \]</div>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}:nowrap:\\\begin{split}  \begin{align}
  m_C =c (\Delta x)(\Delta y)(\Delta z) \\
  \end{align}\end{split}\\However, in porous media, when the pores are fully saturated with water, the volume of water in the gridblock is porosity :math:`\times` total volume: :math:`\theta (\Delta x)(\Delta y)(\Delta z)`, so the mass of solute in the water in the gridblock is the volume of water :math:`\times` the concentration in the water: :math:`c \theta (\Delta x)(\Delta y)(\Delta z)`. Upshot: In our derivation above, wherever we have :math:`m_C` we substitute :math:`c\theta (\Delta x)(\Delta y)(\Delta z)` the\end{aligned}\end{align} \]</div>
<p>result is in our PDE we make this change:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}:nowrap:\\\begin{split}  \begin{align}
  &amp;{\partial c\over \partial t} \rightarrow  {\partial \theta c\over \partial t}  \label{7pde201}\\
  \end{align}\end{split}\\And the equation for diffusion in porous media becomes:\end{aligned}\end{align} \]</div>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}:nowrap:\\\begin{split}  \begin{align}
  &amp;{\partial \theta c\over \partial t} = {\partial \over \partial x}\left( D\theta {\partial c \over \partial x}\right) + {\partial \over \partial y}\left( D\theta  {\partial c \over \partial y}\right)+ {\partial \over \partial z}\left( D \theta {\partial c \over \partial z}\right)  \label{7pde22}\\
  \text{or}&amp;\nonumber\\
  &amp;{\partial \theta c\over \partial t} = \nabla \cdot (D \theta \nabla c)\label{7pde23}\\
  \end{align}\end{split}\\## For homogeneous porosity If porosity is spatially homogeneous, much as above when the diffusion coefficient was homogeneous (constant in space and time) it is not a function of the independent variables :math:`x`, :math:`y`, :math:`z` and :math:`t` so we can pull it out of the derivatives:\ :math:`{\partial \theta c\over \partial t}\rightarrow \theta{\partial c\over \partial t}` and\end{aligned}\end{align} \]</div>
<p><span class="math notranslate nohighlight">\({\partial \over \partial x}\left( D\theta {\partial c \over \partial x}\right)\rightarrow \theta {\partial \over \partial x}\left( D {\partial c \over \partial x}\right)\)</span> and divide through both sides to get</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}:nowrap:\\\begin{split}  \begin{align}
  &amp;{\partial c\over \partial t} = {\partial \over \partial x}\left( D {\partial c \over \partial x}\right) + {\partial \over \partial y}\left( D {\partial c \over \partial y}\right)+ {\partial \over \partial z}\left( D {\partial c \over \partial z}\right)  \label{7pde24}\\
  \end{align}\end{split}\\Surprise! For the case of homogeneous porosity, the equation is the same! However, if you are calculating fluxes between gridblocks, you have to use Fick's law for porous media, :math:`\vec{j} = -D\theta \nabla c`.\end{aligned}\end{align} \]</div>
</div>
</div>
<div class="section" id="Solving-PDEs:-Boundary---value-problems">
<h1>Solving PDEs: Boundary - value problems<a class="headerlink" href="#Solving-PDEs:-Boundary---value-problems" title="Permalink to this headline">¶</a></h1>
<p>The solution to a partial differential equation is a function in space (and time if transient) in a specified domain. Most courses on differential equations focus on methods to determine analytical (sometimes called closed-form) solutions, whereas in this course we focus on discrete approximations. Solving a partial differential equation requires that we establish a so-called boundary-value problem. This is a common-sense collection of information required before we solve the problem.</p>
<div class="section" id="Boundary-value-problem-checklist">
<h2>Boundary-value problem checklist<a class="headerlink" href="#Boundary-value-problem-checklist" title="Permalink to this headline">¶</a></h2>
<p>To solve a boundary value problem requires: 1. knowledge of the equation(s) that govern the dependent variable(s). 2. specification of the problem domain. 3. specification of properties of the problem domain. 4. specification of the value of the dependent variable or its derivatives everywhere on the boundary. 5. for time-dependent problems: ** initial conditions** - specification of the value of the dependent variables at the beginning of period of analysis.</p>
</div>
<div class="section" id="TMF-BVP-example">
<h2>TMF BVP example<a class="headerlink" href="#TMF-BVP-example" title="Permalink to this headline">¶</a></h2>
<p>We were asked to compute the steady-state concentration profile beneath the pond where the concentration at 2 m depth was fixed at <span class="math notranslate nohighlight">\(c=2000~mg/L\)</span> and at the pond-sediment interface <span class="math notranslate nohighlight">\(c=93~mg/L\)</span>. The sulfate moved by diffusion only, and there were no sources or sinks. Let’s go through the check list.</p>
</div>
<div class="section" id="Equation">
<h2>Equation<a class="headerlink" href="#Equation" title="Permalink to this headline">¶</a></h2>
<p>This is a diffusion problem. We argued that because we were looking at a vertical profile in the middle of a large pond, the concentration only varies in one dimension (the vertical). Let’s say <span class="math notranslate nohighlight">\(z\)</span> is the vertical direction. Because the problems is steady, we know <span class="math notranslate nohighlight">\({\partial c\over\partial t} = 0\)</span>. So the equation for steady-state one-dimensional diffusion is:</p>
<div class="math notranslate nohighlight">
\begin{align}
 {\partial \over \partial z}\left( D {\partial c \over \partial z}\right) =0 \label{7pde25}\\
\end{align}</div><p>Note that <span class="math notranslate nohighlight">\(c\)</span> varies with <span class="math notranslate nohighlight">\(z\)</span> only - it is one-dimensional and since it is steady, it does not vary with time. Therefore since in this case concentration is a function of one variable alone, we don’t need partials and can also write</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}:nowrap:\\\begin{split}  \begin{align}
   {d\over d z}\left( D {d c \over d z}\right) =0 \label{7pde26}\\
  \end{align}\end{split}\\Because the diffusion coefficient is spatially homogeneous, we can pull it out of the derivative (as above):\end{aligned}\end{align} \]</div>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}:nowrap:\\\begin{split}  \begin{align}
   D{d^2 c \over d z^2} =0 \label{7pde27}\\
  \end{align}\end{split}\\Finally dividing both sides by the diffusion coefficient :math:`D` we have:\end{aligned}\end{align} \]</div>
<div class="math notranslate nohighlight">
\begin{align}
 {d^2 c \over d z^2} =0 \label{7pde28}\\
\end{align}</div></div>
<div class="section" id="Domain">
<h2>Domain<a class="headerlink" href="#Domain" title="Permalink to this headline">¶</a></h2>
<p>The figure below shows the domain: the 1-D vertical profile under the middle of the pond:</p>
<p>Let’s put the origin <span class="math notranslate nohighlight">\(z=0\)</span> at 2 m depth, so that the pond-sediment interface is at <span class="math notranslate nohighlight">\(z=2~m\)</span>. We could also put the origin at the top and set <span class="math notranslate nohighlight">\(z=2~m\)</span> at 2 m into the sediments.</p>
</div>
<div class="section" id="Properties-of-the-problem-domain">
<h2>Properties of the problem domain<a class="headerlink" href="#Properties-of-the-problem-domain" title="Permalink to this headline">¶</a></h2>
<p>Here the only property needed to describe steady-state concentration profile is the diffusion coefficient <span class="math notranslate nohighlight">\(D\)</span>. For our problem, it’s value was spatially homogeneous <span class="math notranslate nohighlight">\(D=2\times 10^{-10}~m^2/s\)</span>.</p>
</div>
<div class="section" id="Boundary-conditions">
<h2>Boundary conditions<a class="headerlink" href="#Boundary-conditions" title="Permalink to this headline">¶</a></h2>
<p>This problem has two prescribed concentration boundary conditions. 1. <span class="math notranslate nohighlight">\(c(0)=2000~mg/L\)</span> at 2 m depth in the sediments (where <span class="math notranslate nohighlight">\(z=0\)</span>). 2. <span class="math notranslate nohighlight">\(c(2)=93~mg/L\)</span> at the pond-sediment interface (where <span class="math notranslate nohighlight">\(z=2~m\)</span>).</p>
</div>
<div class="section" id="Initial-conditions">
<h2>Initial conditions<a class="headerlink" href="#Initial-conditions" title="Permalink to this headline">¶</a></h2>
<p>Not required since this is not a time-dependent problem.</p>
</div>
</div>
<div class="section" id="Assignment">
<h1>Assignment<a class="headerlink" href="#Assignment" title="Permalink to this headline">¶</a></h1>
</div>
<div class="section" id="1-Finding-an-analytical-solution">
<h1>1 Finding an analytical solution<a class="headerlink" href="#1-Finding-an-analytical-solution" title="Permalink to this headline">¶</a></h1>
<p>Let’s see if we can guess the exact solution to the BVP for the TMF diffusion problem. ## Your turn</p>
<ol class="arabic simple">
<li>You are clever, and guess that the concentration profile varies linearly with depth. That is, the function is of the form</li>
</ol>
<div class="math notranslate nohighlight">
\begin{align}
c(z) &amp;= az + b\\
\end{align}</div><p>where <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> are some coefficients. What are the values of <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> that satisfy the boundary - value problem? Common sense: the solution has to run linearly between the two boundary points. Solve for <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> and enter their values in the cell below for autograding, i.e. write two lines of python that set:</p>
<p>a= xxx b=xxx</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># YOUR CODE HERE</span>
<span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># We test your a and b values here</span>

</pre></div>
</div>
</div>
<ol class="arabic simple" start="2">
<li>Prove that the analytical “solves” the BVP by:</li>
</ol>
<ol class="lowerroman simple">
<li>substituting the analytical expression into the partial differential equation and differentiating (in the same way you proved solutions solved the ODE).</li>
<li>showing that the solution satisfies the boundary conditions. That is, show that <span class="math notranslate nohighlight">\(c(0) = 2000\)</span> and <span class="math notranslate nohighlight">\(c(2) = 93\)</span>.</li>
</ol>
<p>Enter work in the cell below</p>
<p>YOUR ANSWER HERE</p>
<ol class="arabic simple" start="3">
<li>What would the profile look like if the diffusion coefficient were 10 times larger? Or 10 times smaller? Explain in the cell below</li>
</ol>
<p>YOUR ANSWER HERE</p>
<ol class="arabic simple" start="4">
<li>If the porosity of the sediments is <span class="math notranslate nohighlight">\(\theta=0.25\)</span>, what is the magnitude of the specific diffusive flux <span class="math notranslate nohighlight">\(j\)</span> in units of <span class="math notranslate nohighlight">\(mg/(s\cdot m^2)\)</span>. Enter the magnitude of the diffusive flux <span class="math notranslate nohighlight">\(j\)</span> in the cell below for autograding.</li>
</ol>
<p>Spefically we are expecitng you to write a line in python like:</p>
<p>j=xxx</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># your answer here</span>

<span class="c1"># YOUR CODE HERE</span>
<span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Hidden test here</span>

</pre></div>
</div>
</div>
</div>
<div class="section" id="2-Interpretation">
<h1>2 Interpretation<a class="headerlink" href="#2-Interpretation" title="Permalink to this headline">¶</a></h1>
<p>Heat moves by conduction from high temperature to low temperature according to Fourier’s law:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}:nowrap:\\\begin{split}  \begin{align}
  \vec{q} = -\kappa\nabla u \label{7pde29}\\
  \end{align}\end{split}\\where \* :math:`u~\left[\Theta\right]` is the temperature (typical units of Kelvin)(note that :math:`\Theta` is the dimension for temperature) \* :math:`q ~\left[{M \over T^3} \right]` is the specific heat flux (typical units are Watts per :math:`m^2`) \* :math:`\kappa~\left[{M L\over T^3\Theta}\right]` is the thermal conductivity (typical units are Watts per :math:`m` per Kelvin) \* :math:`\nabla u~\left[{\Theta\over L}\right]` is the temperature gradient (typical units are Kelvin per\end{aligned}\end{align} \]</div>
<p><span class="math notranslate nohighlight">\(m\)</span>).</p>
<div class="section" id="1.">
<h2>1.<a class="headerlink" href="#1." title="Permalink to this headline">¶</a></h2>
<p>Show that the dimensions of the left and right hand of Fourier’s law are the same:</p>
<p>Dimensions of <span class="math notranslate nohighlight">\(q\)</span>: <span class="math notranslate nohighlight">\(\left[{M \over T^3} \right]\)</span>; Dimensions of <span class="math notranslate nohighlight">\(-\kappa\nabla u\)</span>: <span class="math notranslate nohighlight">\(\left[{\text{Your dimensions here}}\right]\)</span></p>
<p>The partial differential equation that governs heat flow by conduction can be written in vector form</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}:nowrap:\\\begin{split}  \begin{align}
  &amp;\rho c_p{\partial u\over \partial t} = \nabla \cdot (\kappa \nabla u)\label{7pde30}\\
  \end{align}\end{split}\\where :math:`\rho~\left[{M\over L^3}\right]` is the density of the material through which heat is conducting. This equation is called **the heat equation**.\end{aligned}\end{align} \]</div>
</div>
<div class="section" id="2.">
<h2>2.<a class="headerlink" href="#2." title="Permalink to this headline">¶</a></h2>
<p>What are the dimensions of the specific heat capacity <span class="math notranslate nohighlight">\(c_p\)</span>?</p>
<p><span class="math notranslate nohighlight">\(c_p~\left[{\text{Your dimensions here}}\right]\)</span></p>
</div>
<div class="section" id="3.">
<h2>3.<a class="headerlink" href="#3." title="Permalink to this headline">¶</a></h2>
<p>What is the physical meaning of the the term <span class="math notranslate nohighlight">\(\rho c_p{\partial u\over \partial t}\)</span> in the heat equation <span class="math">\ref{7pde30}</span>?</p>
</div>
<div class="section" id="4.">
<h2>4.<a class="headerlink" href="#4." title="Permalink to this headline">¶</a></h2>
<p>Write the transient heat equation in non-vector form in two dimensions (<span class="math notranslate nohighlight">\(x\)</span>, and <span class="math notranslate nohighlight">\(y\)</span>). Hint: look at diffusion equation examples above.</p>
<div class="math notranslate nohighlight">
\begin{align}
\text{your equation here}
\end{align}</div></div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2019, Philip Austin.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.4.<br/>
    </p>
  </div>
</footer>
  </body>
</html>