<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Assignment &#8212; E213</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"TeX": {"equationNumbers": {"autoNumber": "AMS", "useLabelIds": true}, "extensions": ["color.js"]}, "tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          Home</a>
        <span class="navbar-text navbar-version pull-left"><b>2019Jan01</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../week_notes.html">1. Weekly notes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../week_notes.html#week-1-jan-3">1.1. Week 1  Jan 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week_notes.html#week-2-jan-8-jan-10">1.2. Week 2  Jan 8/Jan 10</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week_notes.html#week-3-jan-15-jan-17">1.3. Week 3  Jan 15/Jan 17</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week_notes.html#week-4-jan-22-jan-24">1.4. Week 4  Jan 22/Jan 24</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week_notes.html#week-5-jan-29-jan-31">1.5. Week 5  Jan 29/Jan 31</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week_notes.html#general-notes">1.6. General notes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../solutions.html">2. Assignment solutions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../solutions.html#week-2">2.1. Week 2</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../texts.html">3. Texts</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../texts.html#math">3.1. Math</a></li>
<li class="toctree-l2"><a class="reference internal" href="../texts.html#python">3.2. Python</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">4. Python</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../getting_started.html#python-introductory-texts">4.1. Python Introductory Texts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started.html#moving-from-matlab-to-python">4.2. Moving from matlab to python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started.html#cocalc">4.3. Cocalc</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cheat_sheet.html">5. Cheat sheet</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../cheat_sheet.html#useful-shell-commands">5.1. Useful shell commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cheat_sheet.html#useful-git-commands">5.2. Useful git commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cheat_sheet.html#useful-debugger-commands">5.3. Useful debugger commands</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../notebook_index.html">6. Notebook index</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../week_notes.html">1. Weekly notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../solutions.html">2. Assignment solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../texts.html">3. Texts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">4. Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cheat_sheet.html">5. Cheat sheet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook_index.html">6. Notebook index</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../_sources/web_notebooks/temporary_notebook.py.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li class="toctree-l1"><a class="reference internal" href="../week_notes.html">1. Weekly notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../solutions.html">2. Assignment solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../texts.html">3. Texts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">4. Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cheat_sheet.html">5. Cheat sheet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebook_index.html">6. Notebook index</a></li>
</ul>

        </div>
      </div>
    <div class="col-md-9 content">
      
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 7ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<h1><p>Table of Contents</p>
</h1><div class="toc"><ul class="toc-item"><li><p>1&nbsp;&nbsp;Assignment</p>
<ul class="toc-item"><li><p>1.1&nbsp;&nbsp;Objectives and description**</p>
</li><li><p>1.2&nbsp;&nbsp;Problem description and conceptual model</p>
</li><li><p>1.3&nbsp;&nbsp;Identification of sulfate sources</p>
<ul class="toc-item"><li><p>1.3.1&nbsp;&nbsp;Parameters</p>
</li></ul></li><li><p>1.4&nbsp;&nbsp;Evolution of the mass of water</p>
</li><li><p>1.5&nbsp;&nbsp;Evolution of the mass of sulfates</p>
</li><li><p>1.6&nbsp;&nbsp;Mass balance</p>
<ul class="toc-item"><li><p>1.6.1&nbsp;&nbsp;Associated ODE</p>
</li><li><p>1.6.2&nbsp;&nbsp;Influence of the timestep</p>
</li></ul></li></ul></li></ul></div><div class="section" id="Assignment">
<h1>Assignment<a class="headerlink" href="#Assignment" title="Permalink to this headline">¶</a></h1>
<div class="section" id="Objectives-and-description**">
<h2>Objectives and description**<a class="headerlink" href="#Objectives-and-description**" title="Permalink to this headline">¶</a></h2>
<p>The objective of this assignment is to create a python program that computes the concentration of sulfate in time in the water in a tailings management facility (TMF) at a mine site.</p>
<p>The goal is to describe the computational approach to the resolution of a typical “0D” problem. In the end, the goal is to understand how the computational approach corresponds to the resolution of an ODE. We will investigate that ODE and study its solutions. That will allow us to compare the accuracy of the numerical solution, because mathematics allowed us to know, in this particular case, the exact solution of a problem.</p>
<p>This assignment is built so that the concepts of the accuracy of a solution are naturally introduced. In the end, you will realize that you will have implemented what is called the forward Euler approach.</p>
</div>
<div class="section" id="Problem-description-and-conceptual-model">
<h2>Problem description and conceptual model<a class="headerlink" href="#Problem-description-and-conceptual-model" title="Permalink to this headline">¶</a></h2>
<p>Sulfate <span class="math notranslate nohighlight">\(SO_{4}^{2 -}\)</span> is one of the “major” dissolved constituents in most terrestrial waters (the others being sodium, calcium, magnesium, bicarbonate and chloride). Sulfate is not poisonous, but much in the same way that too much salt makes water undrinkable, too much sulfate can be too and is thus an environmental concern.</p>
<p>Furthermore, high sulfate concentrations are usually associated with acidic conditions (think about sulfuric acid producing sulfates). In acidic conditions, heavy metals (which are poisonous) might be released from rock dissolution, … Therefore, monitoring and predicting the sulfate content in groundwater is an essential environmental concern.</p>
<p>We will go back to the TMF problem, where we want to know and assess the sulfate concentration evolution through time.</p>
</div>
<div class="section" id="Identification-of-sulfate-sources">
<h2>Identification of sulfate sources<a class="headerlink" href="#Identification-of-sulfate-sources" title="Permalink to this headline">¶</a></h2>
<p>To compute the concentration of sulfate in the TMF water, we need to know where it is coming from and going to and use that knowledge to develop a conceptual model describing the fate of sulfate in our system. That conceptual model will be translated into a computational model.</p>
<p>The figure below is a conceptual sketch of the main sources and losses of sulfate in the TMF water:</p>
<p><img alt="image0" src="../_images/tmf_box.png" /></p>
<ol class="arabic simple">
<li>From the pit. To keep the pit dry, water is constantly pumped out of the pit and put into the TMF at a rate <span class="math notranslate nohighlight">\(Q_{\text{pit}}\)</span> (L/s of water). The pit water has a sulfate concentration of <span class="math notranslate nohighlight">\(c_{\text{pit}}\)</span> in mg/L.</li>
<li>From the mill. The tailings are pumped into the TMF as a slurry of tailings particles (fine, sand-size ground rock) and water. Assume that the water from the mill enters the TMF at a rate of <span class="math notranslate nohighlight">\(Q_{\text{mill}}\ \)</span> (L/s of water), with a sulfate concentration of <span class="math notranslate nohighlight">\(c_{\text{mill}}\)</span> (mg/L).</li>
<li>Diffusing from the tailings porewater at the bottom of the TMF into the water column above. Sulfate dissolves from the tailings particles into the adjacent porewater by oxidation of the sulfide minerals in the particles. Because the ratio of rock to water is high in the tailings sediments at the bottom, the porewater sulfate concentration in the tailings, <span class="math notranslate nohighlight">\(c_{\text{pore}}\)</span>, is always higher than in the water in the TMF. Accordingly, sulfate tends to diffuse into the TMF water from the
bottom porewater at a rate proportional to the difference in concentration between the porewater concentration and the concentration in the TMF, <span class="math notranslate nohighlight">\(c_{\text{TMF}}.\)</span> That is, the flux of sulfate from the bottom can be written (a positive quantity when sulfate is entering into the TMF):</li>
</ol>
<p><span class="math notranslate nohighlight">\(j_{\text{pore}} = k\left( c_{\text{pore}} - c_{\text{TMF}} \right)\)</span></p>
<p>where <span class="math notranslate nohighlight">\(j_{\text{pore}}\ mg/(s \cdot m^{2})\)</span> is the flux rate of sulfate per unit area of the bottom of the TMF and <span class="math notranslate nohighlight">\(k\)</span> is the flux coefficient with units of <span class="math notranslate nohighlight">\(L/(s \cdot m^{2})\)</span> . To compute <span class="math notranslate nohighlight">\(J_{\text{pore}}\)</span>, the total mass flux rate for the whole TMF, with units of <span class="math notranslate nohighlight">\(\frac{\text{mg}}{s}\)</span>, we must multiply the rate per unit area <span class="math notranslate nohighlight">\(j_{\text{area}}\)</span> by the total area of the TMF bottom <span class="math notranslate nohighlight">\(A_{\text{bottom}}\ \)</span> in <span class="math notranslate nohighlight">\(m^{2}\)</span>:</p>
<p><span class="math notranslate nohighlight">\(J_{\text{pore}} = A_{\text{bottom}}{\times j}_{\text{pore}}\)</span></p>
<ol class="arabic simple" start="4">
<li>Leaving via the discharge ditch. Sulfate leaves the TMF with the water that is discharged at a rate <span class="math notranslate nohighlight">\(Q_{\text{discharge}}\)</span> (L/s) from the TMF to the environment. SIMPLIFYING ASSUMPTION: if we assume that the water in the TMF is well mixed at all times, then the concentration in the TMF, <span class="math notranslate nohighlight">\(c_{\text{TMF}}\)</span> is the same at all points in the TMF, and therefore the water leaving the TMF has that same concentration <span class="math notranslate nohighlight">\(c_{\text{TMF}}\ \)</span>.</li>
</ol>
<div class="section" id="Parameters">
<h3>Parameters<a class="headerlink" href="#Parameters" title="Permalink to this headline">¶</a></h3>
<p>You will need these parameters for your model</p>
<table border="1" class="docutils">
<colgroup>
<col width="19%" />
<col width="16%" />
<col width="47%" />
<col width="18%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Symbol</th>
<th class="head">Symbol Units</th>
<th class="head">Description</th>
<th class="head">Value</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><span class="math notranslate nohighlight">\(c_{\text{pit}}\)</span></td>
<td><span class="math notranslate nohighlight">\(mg/L\)</span></td>
<td>Concentration of sulfate in pit water (assume constant)</td>
<td><span class="math notranslate nohighlight">\(50\)</span></td>
</tr>
<tr class="row-odd"><td><span class="math notranslate nohighlight">\(Q_{\text{pit}}\)</span></td>
<td><span class="math notranslate nohighlight">\(L/s\)</span></td>
<td>Flow rate of water from the pit into TMF (assume constant)</td>
<td>30</td>
</tr>
<tr class="row-even"><td><span class="math notranslate nohighlight">\(c_{\text{mill}}\)</span></td>
<td><span class="math notranslate nohighlight">\(mg/L\)</span></td>
<td>Concentration of sulfate in mill water (assume constant)</td>
<td><span class="math notranslate nohighlight">\(700\)</span></td>
</tr>
<tr class="row-odd"><td><span class="math notranslate nohighlight">\(Q_{\text{mill}}\)</span></td>
<td><span class="math notranslate nohighlight">\(L/s\)</span></td>
<td>Flow rate of water from mill into TMF (assume constant)</td>
<td>14</td>
</tr>
<tr class="row-even"><td><span class="math notranslate nohighlight">\(Q_{\text{discharge}}\)</span></td>
<td><span class="math notranslate nohighlight">\(L/s\)</span></td>
<td>Flow rate of water from TMF to environment (assume constant)</td>
<td>44</td>
</tr>
<tr class="row-odd"><td><span class="math notranslate nohighlight">\(c_{\text{pore}}\)</span></td>
<td><span class="math notranslate nohighlight">\(mg/L\)</span></td>
<td>Concentration of sulfate in porewater at bottom of pond</td>
<td>2000</td>
</tr>
<tr class="row-even"><td><span class="math notranslate nohighlight">\(k\)</span></td>
<td><span class="math notranslate nohighlight">\(L/(s \cdot m^{2})\)</span></td>
<td>Flux coefficient from porewater to water column</td>
<td><span class="math notranslate nohighlight">\(2.5 \times 10^{- 5}\)</span></td>
</tr>
<tr class="row-odd"><td><span class="math notranslate nohighlight">\(A_{\text{bottom}}\)</span></td>
<td><span class="math notranslate nohighlight">\(m^{2}\)</span></td>
<td>Total area of TMF bottom</td>
<td><span class="math notranslate nohighlight">\(3 \times 10^{5}\)</span></td>
</tr>
<tr class="row-even"><td><span class="math notranslate nohighlight">\(V_{\text{TMF}}\)</span></td>
<td><span class="math notranslate nohighlight">\(L\)</span></td>
<td>Volume of water in TMF at start of simulation</td>
<td><span class="math notranslate nohighlight">\(8.1 \times 10^{6}\)</span></td>
</tr>
<tr class="row-odd"><td><span class="math notranslate nohighlight">\(c_{0}\)</span></td>
<td><span class="math notranslate nohighlight">\(mg/L\)</span></td>
<td>Concentration of sulfate in TMF water at start of simulation</td>
<td><span class="math notranslate nohighlight">\(93\)</span></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="Evolution-of-the-mass-of-water">
<h2>Evolution of the mass of water<a class="headerlink" href="#Evolution-of-the-mass-of-water" title="Permalink to this headline">¶</a></h2>
<p>First, we will check the evolution of the volume of water in the TMF. Let us denote by <span class="math notranslate nohighlight">\(V(t)\)</span> the volume of water in the TMF at every time step.</p>
<p>The flux from the pit and the mill are positive source terms for the volume of water, while the discharge is a negative source term (a sink term).</p>
<p>Over a certain time <span class="math notranslate nohighlight">\(\Delta t\)</span>, the amount of water (in L) which is coming in/out the TMF are denoted <span class="math notranslate nohighlight">\(S_{\text{pit}}\)</span>, <span class="math notranslate nohighlight">\(S_{\text{mill}}\)</span>, <span class="math notranslate nohighlight">\(S_{\text{dis}}\)</span> and are equal to</p>
<p><span class="math">\begin{equation}
\left\lbrace
\begin{array}{lll}
S_{\text{pit}} & = &  Q_{\text{pit}} \Delta t \\
S_{\text{mill}} & = &  Q_{\text{mill}} \Delta t \\
S_{\text{dis}} & = &  Q_{\text{dis}} \Delta t \\
\end{array}
\right.
\end{equation}</span></p>
<p>Therefore, the volume <span class="math notranslate nohighlight">\(V\)</span> of water in the TMF over the period [<span class="math notranslate nohighlight">\(t\)</span>;$t+:nbsphinx-math:<a href="#id1"><span class="problematic" id="id2">`</span></a>Delta <a href="#id3"><span class="problematic" id="id4">`</span></a>t]$ is:</p>
<p><span class="math">\begin{equation}
\begin{array}{llll}
& V(t+\Delta t) & = &  V(t) + S_{\text{pit}} + S_{\text{mill}} - S_{\text{dis}} \\
\Longleftrightarrow & V(t+\Delta t) & = &  Q_{\text{pit}} \Delta t + Q_{\text{mill}} \Delta t - Q_{\text{dis}} \Delta t \\
\Longleftrightarrow & \frac{V(t+\Delta t)-V(t)}{\Delta t} & = &  Q_{\text{pit}}  + Q_{\text{mill}}  - Q_{\text{dis}}  \\
\end{array}
\end{equation}</span></p>
<p>How does the volume of water change with time?</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">numpy.testing</span> <span class="kn">import</span> <span class="n">assert_almost_equal</span>

<span class="n">Q_pit</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">Q_mill</span> <span class="o">=</span> <span class="mi">14</span>
<span class="n">Q_dis</span> <span class="o">=</span> <span class="mi">44</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># YOUR CODE HERE</span>
<span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>Considering the values given, we have:</p>
<p><span class="math">\begin{equation}
\frac{V(t+\Delta t)-V(t)}{\Delta t} = 30 + 14 - 44 = 0 \Longleftrightarrow V(t) = V_0
\end{equation}</span></p>
<p>Indicating that the volume of water is constant through time!</p>
<p>Let’s assigne a variable whose value is the volume of water in the TMF:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">V0</span> <span class="o">=</span> <span class="mi">0</span>
<span class="c1">#  Change the value of V0 to match the given data</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># YOUR CODE HERE</span>
<span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">V0</span><span class="p">,</span> <span class="mf">8.1e9</span><span class="p">,</span> <span class="n">decimal</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Evolution-of-the-mass-of-sulfates">
<h2>Evolution of the mass of sulfates<a class="headerlink" href="#Evolution-of-the-mass-of-sulfates" title="Permalink to this headline">¶</a></h2>
<p>We have 4 main processes impacting the quantity of sulfates in the TMF. We will compute the evolution of this mass over time. First, initialize the required variable (initial mass, and the different input parameters).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">c0</span> <span class="o">=</span> <span class="mi">93</span>  <span class="c1"># initial concentration</span>

<span class="n">c_pit</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">c_pore</span> <span class="o">=</span> <span class="mi">2000</span>
<span class="n">c_mill</span> <span class="o">=</span> <span class="mi">700</span>

<span class="n">k</span> <span class="o">=</span> <span class="mf">2.5e-5</span>
<span class="n">Area</span> <span class="o">=</span> <span class="mf">3e5</span>
</pre></div>
</div>
</div>
<p>What is the initial mass of sulfates? (in mg)</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">m0</span> <span class="o">=</span> <span class="mi">0</span>
<span class="c1"># Change the value of m0 so that it corresponds to the initial mass (in mg) of sulfates in the TMF.</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># YOUR CODE HERE</span>
<span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">m0</span><span class="p">,</span> <span class="mf">7.533e11</span><span class="p">,</span> <span class="n">decimal</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<ol class="arabic simple">
<li>Advective flux from the pit and the mill</li>
</ol>
<p>We have a source of sulfates from the pit. Over a certain time <span class="math notranslate nohighlight">\(\Delta t\)</span>, the volume of water coming from the pit is <span class="math notranslate nohighlight">\(S_{\text{pit}} = Q_{\text{pit}} \Delta t\)</span>. This volume of water has a sulfate concentration corresponding to the pit concentration. So, the total mass of sulfate from the pit which arrived in the pit over the same period, <span class="math notranslate nohighlight">\(M_{\text{pit}}\)</span> is simply: <span class="math">\begin{equation}
M_{\text{pit}} = S_{\text{pit}}  c_{\text{pit}} = Q_{\text{pit}}  c_{\text{pit}} \Delta t
\end{equation}</span></p>
<p>You can always check the units: <span class="math">\begin{equation}
\overbrace{M_{\text{pit}}}^{mg} = \overbrace{Q_{\text{pit}}}^{L/s}  \, \overbrace{c_{\text{pit}}}^{mg/L} \, \overbrace{\Delta t}^{s}
\end{equation}</span></p>
<p>Compute the mass of sulfates after 1 day if the pit is the only source of sulfate. Create a variable S_pit corresponding to the mass (mg) of sulfates brought by the pit in one day.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">dt</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># day</span>
<span class="n">Seconds_in_a_day</span> <span class="o">=</span> <span class="mi">24</span> <span class="o">*</span> <span class="mi">3600</span>
<span class="n">S_pit</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># YOUR CODE HERE</span>
<span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">S_pit</span><span class="p">,</span> <span class="mi">129600000</span><span class="p">,</span> <span class="n">decimal</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<ol class="arabic simple" start="2">
<li>Advective flux from the mill</li>
</ol>
<p>If we only consider the mill as a sulfate source, how will the mass of sulfates evolve in one day. Assign this value in variable named S_mill (in mg).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">S_mill</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># YOUR CODE HERE</span>
<span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># assert that S_mill = 846720000</span>
<span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">S_mill</span><span class="p">,</span> <span class="mi">846720000</span><span class="p">,</span> <span class="n">decimal</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<ol class="arabic simple" start="3">
<li>Discharge flux from the TMF</li>
</ol>
<p>The same development can be performed for the discharge of water. The volume of water leaving the TMF over a certain period <span class="math notranslate nohighlight">\(\Delta t\)</span> is <span class="math notranslate nohighlight">\(S_{\text{dis}} = Q_{\text{dis}} \Delta t\)</span>. The concentration of sulfates in this volume corresponds to the concentration of sulfates in the TMF <span class="math notranslate nohighlight">\(c_{\text{TMF}}\)</span>, so that we can write:</p>
<p><span class="math">\begin{equation}
M_{\text{dis}} = Q_{\text{dis}}  c_{\text{TMF}} \Delta t
\end{equation}</span></p>
<p>How will the discharge change the mass of sulfates over one day? Create a variable called S_dis which stores that value (in mg).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">S_dis</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># YOUR CODE HERE</span>
<span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">S_dis</span><span class="p">,</span> <span class="mi">353548800</span><span class="p">,</span> <span class="n">decimal</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<ol class="arabic simple" start="4">
<li>First order mass transfer</li>
</ol>
<p>The mass flux was written as: <span class="math">\begin{equation}
J_{\text{pore}} = \overbrace{A_{\text{bottom}}}^{m^2} \overbrace{k}^{L . s^{-1} . m^{-2}}  \left( \overbrace{c_{\text{pore}} - c_{\text{TMF}}}^{mg . L^{-1}} \right)
\end{equation}</span> which is in the units of mg/s. If this flux is constant over time, the added mass of sulfates over a certain time <span class="math notranslate nohighlight">\(\Delta t\)</span> corresponds to the latter quantity multiplied by the the quantity <span class="math notranslate nohighlight">\(J_{\text{pore}}\)</span> multiplied by <span class="math notranslate nohighlight">\(\Delta t\)</span>:</p>
<p><span class="math">\begin{equation}
M_{\text{pore}} = A_{\text{bottom}} k \left( c_{\text{pore}} - c_{\text{TMF}}  \right) \Delta t
\end{equation}</span></p>
<p>How will this mass transfer impact the mass of sulfate? Create a variable S_pore which stores the value (in mg) of the sulfate brought by this first order mass transfer.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">S_pore</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># YOUR CODE HERE</span>
<span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># ASSERT THAT S_PORE = 1235736000.0</span>
<span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">S_pore</span><span class="p">,</span> <span class="mi">1235736000</span><span class="p">,</span> <span class="n">decimal</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Now, compute the total evolution of the mass of sulfates after one day, and print its value and how it has changed. Store that value (in mg) in a variable called m1.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">m1</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># YOUR CODE HERE</span>
<span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="mi">755158507200</span><span class="p">,</span> <span class="n">decimal</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>This is the mass after 1 day (in mg). What is the concentration after one day? Store that value in a variable called c1 (in mg/L).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">c1</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># YOUR CODE HERE</span>
<span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># assert that c1=93.2294453333</span>
<span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="mf">93.2294453333</span><span class="p">,</span> <span class="n">decimal</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>We can see that concentration has increased by only 0.2%.</p>
<p>We have computed the evolution of the mass of sulfates in the TMF after one day. How would you do that after another day?</p>
<p>We will use a loop to do that calculation, to compute the evolution of the concentration over a large period of time (10 years, for example), using daily timesteps again.</p>
<p>At the end, we want to plot the evolution of the concentration, so we have to store its values in an array, whose size corresponds to the amount of timesteps required.</p>
<p>Using daily timesteps, what size would that array need to be if we want to monitor the concentration for 10 years. That size is an integer called n.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">Tf</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># years</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># YOUR CODE HERE</span>
<span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3651</span><span class="p">,</span> <span class="n">decimal</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="c1"># Let us assign some arrays to describe our problem</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>  <span class="c1"># represents the mass of sulfates (mg) at each time</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>  <span class="c1"># represents the concentration of sultates (mg/L) at each time</span>
<span class="n">Spit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
    <span class="n">n</span><span class="p">,</span> <span class="nb">float</span>
<span class="p">)</span>  <span class="c1"># represents at each time, the amount of sulfates (in kg) brought by the pit</span>
<span class="n">Smill</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
    <span class="n">n</span><span class="p">,</span> <span class="nb">float</span>
<span class="p">)</span>  <span class="c1"># represents at each time, the amount of sulfates (in kg) brought by the mill</span>
<span class="n">Sdis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
    <span class="n">n</span><span class="p">,</span> <span class="nb">float</span>
<span class="p">)</span>  <span class="c1"># represents at each time, the amount of sulfates (in kg) discharged</span>
<span class="n">Spore</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
    <span class="n">n</span><span class="p">,</span> <span class="nb">float</span>
<span class="p">)</span>  <span class="c1"># represents at each time, the amount of sulfates (in kg) brought by the tailing</span>
<span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>  <span class="c1"># represents the time at each timestep</span>
<span class="n">discharge</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
    <span class="n">n</span><span class="p">,</span> <span class="nb">float</span>
<span class="p">)</span>  <span class="c1"># represents the cumulative discharge of sulfates (in kg)</span>
</pre></div>
</div>
</div>
<p>First, we initialize the initial mass and concentrations.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">m0</span>
<span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">c0</span>
</pre></div>
</div>
</div>
<p>Then, we need to compute these terms at every timesteps, by looping over the different times</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># YOUR CODE HERE</span>
<span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="mf">454.46947737053875</span><span class="p">,</span> <span class="n">decimal</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">discharge</span><span class="p">[</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="mf">4.584599422624083e06</span><span class="p">,</span> <span class="n">decimal</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The calculation is now performed, let us look at the results using matplotlib. Design 3 vertically stacked plots 1. The first should show the evolution of the concentration over time 2. The second should show the relative importance of the different sources/sinks 3. The third should show the cumulative discharge (in kg) of sulfates</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># YOUR CODE HERE</span>
<span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Mass-balance">
<h2>Mass balance<a class="headerlink" href="#Mass-balance" title="Permalink to this headline">¶</a></h2>
<div class="section" id="Associated-ODE">
<h3>Associated ODE<a class="headerlink" href="#Associated-ODE" title="Permalink to this headline">¶</a></h3>
<p>We can (and you will!) show that this problem can be described by a linear non-homogeneous 1st order ODE. We can (and you will) verify that the solution to this ODE is given by:</p>
<p><span class="math">\begin{equation}
c_{\text{TMF}}(t) = \frac{Q}{\lambda} + A \mathrm{exp}(-\lambda t)
\end{equation}</span></p>
<p>where <span class="math">\begin{equation}
\left\lbrace
\begin{array}{lll}
Q & = & \frac{Q_{\text{pit}}c_{\text{pit}} + Q_{\text{mill}}c_{\text{mill}}+ A_{\text{bottom}}kc_{\text{p}}}{V_0} \\
\lambda & = & \frac{A_{\text{bottom}}k+Q_{\text{dis}}}{V_0}
\end{array}
\right.
\end{equation}</span></p>
<p>Find the value of A so that the initial condition is satisfied.</p>
<p>% A = 0 Assign A to its real value so that the previous solution matches the initial ccondition of the problem</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># YOUR CODE HERE</span>
<span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>Again, we want a triple vertical plots (with time as x-axis). 1. The first plot shows the computed solution vs the analytical solution 2. The second plot shows the absolute error (computed_solution - real solution) 3. The third plot shows the relative error (computed_solution-real_solution)/real_solution</p>
<p>To do that, you need to compute the real solution and store it in an array. You also have to compute the error and relative error. The next cell should contain the analytical calculation of the real solution and every plot material.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># YOUR CODE HERE</span>
<span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Influence-of-the-timestep">
<h3>Influence of the timestep<a class="headerlink" href="#Influence-of-the-timestep" title="Permalink to this headline">¶</a></h3>
<p>The error is arising from the timestepping approach we have used. During one timestep, we have computed the discharge flux and the source-term from the “pore” as if the concentration <span class="math notranslate nohighlight">\(c_{\text{TMF}}\)</span> was constant through the timestep. This is actually not true. So, the bigger the timesteps, the bigger the error.</p>
<p>Try the same methods used above for different timesteps (0.1 day, 1 day, 10 days, 50 days) and compare each of these solutions to the real solution and comment on the error.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># YOUR CODE HERE</span>
<span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>How would you change the method if the volume of water was not constant?</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># YOUR CODE HERE</span>
<span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2019, Philip Austin.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.3.<br/>
    </p>
  </div>
</footer>
  </body>
</html>